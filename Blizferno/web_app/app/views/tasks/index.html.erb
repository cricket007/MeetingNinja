<!-- PLACE JAVASCRIPT IN app/assets/javascripts/tasks.js -->
<script src="http://code.jquery.com/jquery-latest.min.js"
        type="text/javascript"></script>

<!-- Modal -->
<div class="modal fade" id="TaskModal" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div  id="header" class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
      </div>
      <div class="modal-body">
        <form name="input" id="body">
        </form>
      </div>
      <div id="footer" class="modal-footer">
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

<h1 style='margin-left: 15%; margin-right: auto;'>Tasks</h1>
<table class='table table-hover table-striped' style='width: 70%; margin-left: 15%; margin-right: auto;'>

  <thead>
  <tr>
    <td colspan='4' style='cursor: pointer; text-align: center' onclick="showNewTaskModal('<%=@allUsers%>', 'TaskModal')" data-toggle='modal'><span style='font-size: 1.3em; color: white;' class='glyphicon glyphicon-plus'></span><span style='font-size: 1.1em; color: white;'>  Create New</span></td>
  </tr>
    <tr >
      <th>Due</th>
      <th>Task Name</th>
      <th>Completion Criteria</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <% if !(@tasks.any?) %>
    <tr>
      <td colspan="3" style="text-align: center;">YOU DO NOT HAVE ANY TASKS</td>
    </tr>
  <% else %>
    <% counter = 0; max= @tasks.length; addedTasks = [ ]; %>
      <% for task in @tasks%>
        <% if counter >= max %>
          <%break%>
        <% elsif addedTasks.include? task['taskID'] %>
          <% next %>
        <% else %>
          <tr>
            <td onClick="showViewTaskModal(<%= task['taskID'] %>, '<%= @allUsers %>')" data-refresh="true" data-toggle='modal'><%= Time.at(task['deadline']) %>
            </td>
            <td onClick="showViewTaskModal(<%= task['taskID'] %>, '<%= @allUsers %>')" data-refresh="true" data-toggle='modal'><%= task['title'] %>
            </td>
            <td onClick="showViewTaskModal(<%= task['taskID'] %>, '<%= @allUsers %>')" data-refresh="true" data-toggle='modal'><%= task['completionCriteria'] %>
            </td>
            <td colspan='1' style='cursor: pointer; text-align: center' onClick="showDeleteTaskModal(<%= task['taskID'] %>)"  data-refresh="true" data-toggle='modal'>
              <span style='font-size: 1.3em; color: white;' class='glyphicon glyphicon-trash'>
              </span>
            </td>
            <td onclick="showEditTaskModal(<%= task['taskID'] %> %>, '<%= @allUsers %>')">
              <span style='font-size: 1.3em; color: white; cursor: pointer;' class='glyphicon glyphicon-pencil' >
              </span>
            </td>
          </tr>
          <% addedTasks.push(task['taskID']) %>
          <% counter = counter + 1%>
        <% end %>
      <% end %>
  <% end %>
</table>
